<html>
<head>
	<meta charset="UTF-8">
	<title>Каменогорск. Уровень 2. Блок водоподготовки</title>
	<link rel="stylesheet" href="/leaflet.css" />
<link rel="stylesheet" href="/css/areal.css" />
	<script src="/leaflet.js" type="text/javascript"></script>
	<script src="./dist/PruneCluster.js" type="text/javascript"></script>
	<script src="./layer/Marker.Text.js" type="text/javascript"></script>
	<script src="./jquery-2.1.1.min.js" type="text/jscript"></script>
	
	<script src="./draw/src/leaflet.circle.topolygon-src.js"></script>
	<script src="./draw/src/Leaflet.draw.js"></script>
    <script src="./draw/src/Leaflet.Draw.Event.js"></script>
    <link rel="stylesheet" href="./draw/src/leaflet.draw.css"/>

    <script src="./draw/src/Toolbar.js"></script>
    <script src="./draw/src/Tooltip.js"></script>

    <script src="./draw/src/ext/GeometryUtil.js"></script>
    <script src="./draw/src/ext/LatLngUtil.js"></script>
    <script src="./draw/src/ext/LineUtil.Intersect.js"></script>
    <script src="./draw/src/ext/Polygon.Intersect.js"></script>
    <script src="./draw/src/ext/Polyline.Intersect.js"></script>
    <script src="./draw/src/ext/TouchEvents.js"></script>

    <script src="./draw/src/draw/DrawToolbar.js"></script>
    <script src="./draw/src/draw/handler/Draw.Feature.js"></script>
    <script src="./draw/src/draw/handler/Draw.SimpleShape.js"></script>
    <script src="./draw/src/draw/handler/Draw.Polyline.js"></script>
    <script src="./draw/src/draw/handler/Draw.Circle.js"></script>
    <script src="./draw/src/draw/handler/Draw.Marker.js"></script>
    <script src="./draw/src/draw/handler/Draw.Polygon.js"></script>
    <script src="./draw/src/draw/handler/Draw.Rectangle.js"></script>


    <script src="./draw/src/edit/EditToolbar.js"></script>
    <script src="./draw/src/edit/handler/EditToolbar.Edit.js"></script>
    <script src="./draw/src/edit/handler/EditToolbar.Delete.js"></script>

    <script src="./draw/src/Control.Draw.js"></script>

    <script src="./draw/src/edit/handler/Edit.Poly.js"></script>
    <script src="./draw/src/edit/handler/Edit.SimpleShape.js"></script>
    <script src="./draw/src/edit/handler/Edit.Circle.js"></script>
    <script src="./draw/src/edit/handler/Edit.Rectangle.js"></script>
    <script src="./draw/src/edit/handler/Edit.Marker.js"></script>
	
	
	<script src="./dist/easy-button.js" type="text/javascript"></script>
	<link rel="stylesheet" href="./dist/easy-button.css"/>
	<script src="./dist/jQuery.print.js" type="text/javascript"></script>
	
	
</head>
<body oncontextmenu="return false">
	<div style="position:absolute; top:0px; left:0px; height:30px; width:1000px; background: #bfbfbf; padding:10px; overflow-y: scroll;" id="brief"><table border="0"><tr>	<td width="90px" ><span id="vP1">?</span></td>	<td width="90px" ><span id="vP2">?</span></td>	<td width="90px" ><span id="vP3">?</span></td>	<td width="90px" ><span id="vP4">?</span></td>	<td width="90px" ><span id="vP5">?</span></td>	<td width="90px" ><span id="vP6">?</span></td>	<td width="90px" ><span id="vP7">?</span></td>	<td width="90px" ><span id="vP8">?</span></td>	<td width="90px" ><span id="vP9">?</span></td>	<td width="90px" ><span id="vP0">?</span></td>	</tr></table>	</div>	<div style="position:absolute; width:1000px; bottom:0px; top:50px;" id="map"></div>
	<div style="position:absolute; width:990px; bottom:0px; top:0px; left:0px; background: #aeaeae; padding:10px; display:none; z-index:1200; "  id="detail">
		<h1><a href="#" onclick=' $("#detail").hide(); return false;' ><img src="images/close.png" alt="Закрыть" border="0" width="30px" height="30px" /></a> Детальная информация</h1>
		<hr>
		<div id="detail_info">
		</div>
	</div>
	<div style="position:absolute; top:0px; left:1008px; right:0px; bottom:0px; background: #bfbfbf; padding:10px; overflow-y: scroll;" id="brief">
<h1>
	<a href="level1.html"><img src="images\home.png" alt="Главный экран" width="50px"; height="50px"; /></a>
	<img src="/images/areal.logo.png" border="0"; width="250px"; height="50px";  align="right" />
	</h1>
	<a href="level2.8.html"><h2>Блок водоподготовки</h2></a>
	<h2>Подсистема 6 (ШУ4)</h2>
	<!-- <h3> Датчики </h3>
	<ul>
	<li><a href="#" onclick='GetDitail("86.41");'>LT9a  : <span id="v86.41">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.42");'>FE14a : <span id="v86.42">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.43");'>LT15a : <span id="v86.43">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.44");'>FE20a : <span id="v86.44">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.45");'>    8 : <span id="v86.45">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.46");'>    9 : <span id="v86.46">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.47");'>   10 : <span id="v86.47">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.48");'>   20 : <span id="v86.48">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.49");'>   21 : <span id="v86.49">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.50");'>   22 : <span id="v86.50">?</span></a></li>
	</ul>
	-->
	
	<h3> Управление </h3>
	<ul>
	<li><a href="#" onclick='GetDitail("86.21");'>Задвижка 3M  : <span id="v86.21">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.22");'>Задвижка 2M1 : <span id="v86.22">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.23");'>Задвижка 2M2 : <span id="v86.23">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.24");'>Задвижка 4M  : <span id="v86.24">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.25");'>Задвижка 2M3 : <span id="v86.25">?</span></a></li>
	<li><a href="#" onclick='GetDitail("86.26");'>Задвижка 2M4 : <span id="v86.26">?</span></a></li>
	
	</ul>
	
		<hr>

	<span id="v214"></span><br/>
	<span id="v215"></span><br/>
	<span id="v216"></span><br/>
	<span id="v217"></span><br/>
	<span id="v218"></span><br/>
	<span id="v219"></span><br/>
	<span id="v220"></span><br/>
	<span id="v221"></span><br/>
	
	
	</div>
<script type='text/javascript'>
function GetDitail(sid){
 return; 

	$("#detail").show(); 
	var item=document.getElementById('detail_info');
	if( item!=null){
		item.innerHTML =sid;
	}else{
		console.log(v.ID);
	}
	return false;
}
	var imgW=656;
	var imgH=926;

	var imageUrl = './images/l2_8.6.png', imageBounds = [[-imgH/20, -imgW/20], [imgH/20, imgW/20]];
	
	var map = L.map('map', { minZoom: 2, maxZoom: 7,attributionControl:false});  //.setView([27, 44], 3);
    map.attributionControl = false;
    L.imageOverlay(imageUrl, imageBounds, { opacity: 1 }).addTo(map); // , attribution: 'Цех:<%=GetC()%>'
	map.setView([0, 0], 4);
	map.fitBounds(imageBounds);
	map.setMaxBounds([[-imgH/15, -imgW/15], [imgH/15, imgW/15]])
	
		L.easyButton({
	  id: 'id-map-print',  // an id for the generated button
	  position: 'topleft',      // inherited from L.Control -- the corner it goes in
	  type: 'replace',          // set to animate when you're comfy with css
	  leafletClasses: true,     // use leaflet classes to style the button?
	  states:[{                 // specify different icons and responses for your button
		stateName: 'map-print',
		onClick: function(button, map){
			$('#map').print();
		},
		title: 'Печать',
		icon: '<img src="/images/print.png" width="18px;" height="18px">'
	  }]
	}).addTo( map );
	/* var  drawnItems = L.featureGroup().addTo(map);
	
	
    map.addControl(new L.Control.Draw({
        edit: {
            featureGroup: drawnItems,
            poly: {
                allowIntersection: false
            }
        },
        draw: {
            polygon: {
                allowIntersection: false,
                showArea: true
            }
        }
    }));
	*/
	
	

	var rgb = '#00FF00'; // green
	var bounds;
    map.on(L.Draw.Event.CREATED, function (event) {
        var layer = event.layer;
        var s ="";
		if(typeof layer.toPolygon =='undefined'){
			s= JSON.stringify(layer.toGeoJSON()) ;
			drawnItems.addLayer(layer);
		}else{
			
			//alert ( JSON.stringify(layer.toPolygon(24,map)) );
			bounds=layer.toPolygon(24,map);
			var player= L.polygon( bounds, {  color: rgb, opacity: 1.0, fillOpacity: 1, weight: 1 } );
			s= JSON.stringify(player.toGeoJSON());
			drawnItems.addLayer(player);
		}
		
		$.ajax({
		  type: 'GET',
		  url: 'savelayer.aspx',
		  data: 'P=l2_86&L=' +s,
		  success: function(data){
			//$('.results').html(data);
		  }
		});
		
    });
	
	
	
	
	
	
	map.on('contextmenu',function(event){ }); 
 var stanki =[];
	var blink=true;
	  
	    function MapX(X) {
            var mx = parseInt(X);
            mx = mx / 10 -imgW/20;
            return mx;
        }

        function MapY(Y) {
            var my = parseInt(Y);
            my =  imgH/20 - my / 10;
            return my;
        }
	
	var rect;
	var bounds;
	var rgb = '#dddddd';
	var marker;
	
	/*
    bounds=FlipLL([[-24.22371736273737,39.07699987472513,0],[-24.519549849343814,38.95446204658219,0],[-24.773586964743394,38.759532511987764,0],[-24.96851649933782,38.50549539658818,0],[-25.091054327480766,38.20966290998174,0],[-25.13284969868762,37.89219554724437,0],[-25.091054327480766,37.574728184507,0],[-24.96851649933782,37.27889569790056,0],[-24.773586964743394,37.024858582500976,0],[-24.519549849343814,36.82992904790655,0],[-24.22371736273737,36.70739121976361,0],[-23.906250000000004,36.66559584855675,0],[-23.588782637262632,36.70739121976361,0],[-23.292950150656193,36.82992904790655,0],[-23.038913035256613,37.024858582500976,0],[-22.843983500662187,37.27889569790056,0],[-22.72144567251924,37.574728184507,0],[-22.679650301312385,37.89219554724437,0],[-22.72144567251924,38.20966290998174,0],[-22.843983500662187,38.50549539658818,0],[-23.03891303525661,38.759532511987764,0],[-23.292950150656193,38.95446204658219,0],[-23.588782637262632,39.07699987472513,0],[-24.22371736273737,39.07699987472513,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.41';
	//rect.bindPopup('Датчик 1');
	rect.bindTooltip('Датчик 1')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	 
	
	bounds=FlipLL([[-16.59626633377308,41.1992742038983,0],[-16.90983507533699,41.06938977840626,0],[-17.179102658150992,40.86277349512522,0],[-17.385718941432035,40.593505912311215,0],[-17.51560336692407,40.27993717074731,0],[-17.559904525673975,39.94343646197423,0],[-17.51560336692407,39.60693575320115,0],[-17.385718941432035,39.293367011637244,0],[-17.179102658150992,39.02409942882324,0],[-16.90983507533699,38.8174831455422,0],[-16.59626633377308,38.68759872005016,0],[-16.259765625000004,38.64329756130026,0],[-15.923264916226925,38.68759872005016,0],[-15.609696174663018,38.8174831455422,0],[-15.340428591849015,39.02409942882324,0],[-15.133812308567972,39.293367011637244,0],[-15.003927883075939,39.60693575320115,0],[-14.959626724326032,39.94343646197423,0],[-15.003927883075937,40.27993717074731,0],[-15.133812308567972,40.593505912311215,0],[-15.340428591849015,40.86277349512522,0],[-15.609696174663016,41.06938977840626,0],[-15.923264916226923,41.1992742038983,0],[-16.59626633377308,41.1992742038983,0]]) ;
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.42';
	//rect.bindPopup('Датчик 2');
	rect.bindTooltip('Датчик 2')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	bounds=FlipLL([[-25.595659245615344,-9.158994394147628,0],[-25.900472168660965,-9.285252040859712,0],[-26.162220959658484,-9.48609895226297,0],[-26.363067871061745,-9.747847743260488,0],[-26.48932551777383,-10.052660666306112,0],[-26.532389649821933,-10.379765224421455,0],[-26.48932551777383,-10.706869782536797,0],[-26.363067871061745,-11.011682705582421,0],[-26.162220959658484,-11.273431496579938,0],[-25.900472168660965,-11.474278407983197,0],[-25.595659245615344,-11.600536054695281,0],[-25.2685546875,-11.643600186743388,0],[-24.941450129384656,-11.600536054695281,0],[-24.63663720633903,-11.474278407983197,0],[-24.374888415341516,-11.273431496579938,0],[-24.174041503938255,-11.011682705582421,0],[-24.04778385722617,-10.706869782536797,0],[-24.004719725178067,-10.379765224421455,0],[-24.04778385722617,-10.052660666306112,0],[-24.174041503938255,-9.74784774326049,0],[-24.374888415341516,-9.486098952262973,0],[-24.63663720633903,-9.285252040859714,0],[-24.941450129384656,-9.158994394147628,0],[-25.595659245615344,-9.158994394147628,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.43';
	//rect.bindPopup('Датчик 3');
	rect.bindTooltip('Датчик 3')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	
	bounds=FlipLL([[-17.984027308218405,-6.480605723554481,0],[-18.28036702076463,-6.603353651560871,0],[-18.534839700953178,-6.798617406772883,0],[-18.73010345616519,-7.053090086961431,0],[-18.85285138417158,-7.349429799507654,0],[-18.89471841652925,-7.667441482726056,0],[-18.85285138417158,-7.985453165944457,0],[-18.73010345616519,-8.28179287849068,0],[-18.534839700953178,-8.53626555867923,0],[-18.28036702076463,-8.73152931389124,0],[-17.984027308218405,-8.85427724189763,0],[-17.666015625000004,-8.896144274255304,0],[-17.348003941781602,-8.85427724189763,0],[-17.051664229235378,-8.73152931389124,0],[-16.79719154904683,-8.536265558679228,0],[-16.601927793834818,-8.28179287849068,0],[-16.479179865828428,-7.985453165944458,0],[-16.437312833470756,-7.667441482726056,0],[-16.479179865828428,-7.3494297995076545,0],[-16.601927793834818,-7.053090086961432,0],[-16.79719154904683,-6.798617406772884,0],[-17.051664229235378,-6.603353651560871,0],[-17.3480039417816,-6.480605723554482,0],[-17.984027308218405,-6.480605723554481,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.44';
	//rect.bindPopup('Датчик 4');
	rect.bindTooltip('Датчик 4')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	bounds=FlipLL([[6.656864203678023,43.755770731002805,0],[6.3079921806736055,43.61126320754184,0],[6.008408982816222,43.38138493468083,0],[5.778530709955213,43.08180173682345,0],[5.634023186494245,42.73292971381903,0],[5.58473436134721,42.35854391749705,0],[5.634023186494244,41.98415812117507,0],[5.778530709955213,41.63528609817066,0],[6.008408982816222,41.33570290031327,0],[6.3079921806736055,41.105824627452265,0],[6.656864203678023,40.9613171039913,0],[7.031250000000002,40.91202827884426,0],[7.40563579632198,40.9613171039913,0],[7.754507819326397,41.105824627452265,0],[8.05409101718378,41.33570290031327,0],[8.283969290044789,41.63528609817066,0],[8.428476813505757,41.98415812117507,0],[8.477765638652793,42.35854391749705,0],[8.428476813505757,42.73292971381903,0],[8.28396929004479,43.081801736823444,0],[8.05409101718378,43.38138493468083,0],[7.754507819326398,43.61126320754184,0],[7.405635796321982,43.755770731002805,0],[6.656864203678023,43.755770731002805,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.45';
	//rect.bindPopup('Датчик 5');
	rect.bindTooltip('Датчик 5')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	 
	
	bounds=FlipLL([[17.857403547732133,43.48232157267105,0],[17.544342554899313,43.352647463589705,0],[17.27551098580535,43.14636574540317,0],[17.06922926761882,42.87753417630921,0],[16.93955515853748,42.56447318347639,0],[16.895325734798625,42.22851735620852,0],[16.93955515853748,41.892561528940654,0],[17.06922926761882,41.57950053610783,0],[17.27551098580535,41.31066896701387,0],[17.544342554899313,41.10438724882734,0],[17.857403547732133,40.974713139745994,0],[18.193359375000004,40.93048371600714,0],[18.529315202267874,40.974713139745994,0],[18.842376195100695,41.10438724882734,0],[19.11120776419466,41.31066896701387,0],[19.317489482381188,41.57950053610783,0],[19.447163591462527,41.892561528940654,0],[19.491393015201382,42.22851735620852,0],[19.447163591462527,42.56447318347639,0],[19.317489482381188,42.87753417630921,0],[19.11120776419466,43.14636574540317,0],[18.842376195100695,43.352647463589705,0],[18.529315202267874,43.48232157267105,0],[17.857403547732133,43.48232157267105,0]]) ;
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.46';
	//rect.bindPopup('Датчик 6');
	rect.bindTooltip('Датчик 6')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	bounds=FlipLL([[29.692230283138677,43.46550948355329,0],[29.350833881099692,43.32409846368336,0],[29.05767014449778,43.09914601669196,0],[28.83271769750638,42.80598228009005,0],[28.691306677636454,42.46458587805107,0],[28.64307401219938,42.09822241118974,0],[28.69130667763645,41.73185894432841,0],[28.83271769750638,41.39046254228943,0],[29.05767014449778,41.097298805687515,0],[29.350833881099692,40.87234635869611,0],[29.692230283138677,40.730935338826185,0],[30.058593750000004,40.682702673389116,0],[30.42495721686133,40.730935338826185,0],[30.766353618900315,40.87234635869611,0],[31.059517355502226,41.097298805687515,0],[31.28446980249363,41.39046254228943,0],[31.425880822363553,41.73185894432841,0],[31.474113487800626,42.09822241118974,0],[31.425880822363556,42.46458587805107,0],[31.284469802493632,42.80598228009005,0],[31.05951735550223,43.09914601669196,0],[30.766353618900315,43.32409846368336,0],[30.424957216861333,43.46550948355329,0],[29.692230283138677,43.46550948355329,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.47';
	//rect.bindPopup('Датчик 7');
	rect.bindTooltip('Датчик 7')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	
	bounds=FlipLL([[5.278372421106756,-4.059889619603145,0],[4.955366938885928,-4.193682871059873,0],[4.677995843159068,-4.406517198496389,0],[4.465161515722553,-4.683888294223249,0],[4.331368264265824,-5.006893776444077,0],[4.285733877771856,-5.353521355337321,0],[4.331368264265824,-5.7001489342305645,0],[4.465161515722552,-6.023154416451392,0],[4.677995843159068,-6.300525512178253,0],[4.955366938885928,-6.513359839614769,0],[5.278372421106756,-6.647153091071497,0],[5.625,-6.692787477565465,0],[5.971627578893244,-6.647153091071497,0],[6.294633061114073,-6.513359839614768,0],[6.572004156840933,-6.300525512178252,0],[6.784838484277448,-6.023154416451392,0],[6.918631735734176,-5.700148934230565,0],[6.964266122228144,-5.353521355337321,0],[6.918631735734176,-5.006893776444078,0],[6.784838484277448,-4.68388829422325,0],[6.572004156840933,-4.40651719849639,0],[6.294633061114074,-4.193682871059874,0],[5.971627578893246,-4.059889619603146,0],[5.278372421106756,-4.059889619603145,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.48';
	//rect.bindPopup('Датчик 8');
	rect.bindTooltip('Датчик 8')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	bounds=FlipLL([[16.33525455495052,-4.257652951094751,0],[15.99609391831439,-4.398137886612529,0],[15.70485007698891,-4.621617146144233,0],[15.481370817457206,-4.912860987469713,0],[15.340885881939428,-5.252021624105844,0],[15.292969086628776,-5.615985819155327,0],[15.340885881939428,-5.9799500142048085,0],[15.481370817457206,-6.31911065084094,0],[15.70485007698891,-6.610354492166421,0],[15.99609391831439,-6.8338337516981245,0],[16.33525455495052,-6.974318687215903,0],[16.699218750000004,-7.022235482526553,0],[17.063182945049487,-6.974318687215902,0],[17.402343581685617,-6.833833751698124,0],[17.6935874230111,-6.61035449216642,0],[17.9170666825428,-6.31911065084094,0],[18.05755161806058,-5.9799500142048085,0],[18.10546841337123,-5.615985819155327,0],[18.05755161806058,-5.252021624105845,0],[17.917066682542803,-4.912860987469715,0],[17.6935874230111,-4.621617146144234,0],[17.402343581685617,-4.398137886612531,0],[17.063182945049487,-4.257652951094752,0],[16.33525455495052,-4.257652951094751,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.49';
	//rect.bindPopup('Датчик 9');
	rect.bindTooltip('Датчик 9')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	 
	
	bounds=FlipLL([[28.314048302870557,-4.440912185493183,0],[27.998807131403325,-4.571489354133293,0],[27.728103400473127,-4.779207632622628,0],[27.520385121983793,-5.049911363552824,0],[27.389807953343684,-5.365152535020058,0],[27.345270512806646,-5.703447982149503,0],[27.389807953343684,-6.041743429278948,0],[27.520385121983793,-6.3569846007461805,0],[27.728103400473127,-6.627688331676378,0],[27.998807131403325,-6.8354066101657125,0],[28.31404830287056,-6.965983778805823,0],[28.652343750000004,-7.010521219342859,0],[28.99063919712945,-6.965983778805823,0],[29.305880368596682,-6.8354066101657125,0],[29.57658409952688,-6.627688331676377,0],[29.784302378016214,-6.3569846007461805,0],[29.914879546656323,-6.041743429278948,0],[29.95941698719336,-5.703447982149503,0],[29.914879546656323,-5.365152535020059,0],[29.784302378016214,-5.049911363552825,0],[29.57658409952688,-4.7792076326226285,0],[29.305880368596682,-4.571489354133294,0],[28.99063919712945,-4.4409121854931835,0],[28.314048302870557,-4.440912185493183,0]]) ;
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.50';
	//rect.bindPopup('Датчик 10');
	rect.bindTooltip('Датчик 10')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	*/
	
	bounds=FlipLL([[-13.645167454017889,37.979647291978,0],[-13.788632088360254,37.92022229471249,0],[-13.911827962783185,37.82569077546011,0],[-14.006359482035569,37.70249490103718,0],[-14.065784479301072,37.55903026669481,0],[-14.086053239220508,37.405073750176925,0],[-14.065784479301072,37.25111723365904,0],[-14.006359482035569,37.10765259931667,0],[-13.911827962783185,36.98445672489374,0],[-13.788632088360254,36.88992520564136,0],[-13.645167454017889,36.83050020837585,0],[-13.491210937500002,36.81023144845642,0],[-13.337254420982115,36.83050020837585,0],[-13.193789786639748,36.88992520564136,0],[-13.070593912216818,36.98445672489374,0],[-12.976062392964435,37.10765259931667,0],[-12.916637395698931,37.25111723365904,0],[-12.896368635779496,37.405073750176925,0],[-12.916637395698931,37.55903026669481,0],[-12.976062392964435,37.70249490103718,0],[-13.070593912216816,37.82569077546011,0],[-13.193789786639748,37.92022229471249,0],[-13.337254420982115,37.979647291978,0],[-13.645167454017889,37.979647291978,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.21';
	//rect.bindPopup('Задвижка 1');
	rect.bindTooltip('Задвижка 1')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	 
	
	bounds=FlipLL([[-25.135321295062298,24.174509242013315,0],[-25.297821122673945,24.107199609533282,0],[-25.437362888126874,24.000125446951017,0],[-25.54443705070914,23.86058368149809,0],[-25.61174668318917,23.69808385388644,0],[-25.634704745347893,23.523700058824144,0],[-25.61174668318917,23.349316263761846,0],[-25.54443705070914,23.1868164361502,0],[-25.437362888126874,23.04727467069727,0],[-25.297821122673945,22.940200508115005,0],[-25.135321295062298,22.872890875634972,0],[-24.9609375,22.84993281347625,0],[-24.786553704937702,22.872890875634972,0],[-24.624053877326055,22.94020050811501,0],[-24.484512111873126,23.04727467069727,0],[-24.37743794929086,23.1868164361502,0],[-24.31012831681083,23.349316263761846,0],[-24.287170254652107,23.523700058824144,0],[-24.31012831681083,23.69808385388644,0],[-24.37743794929086,23.86058368149809,0],[-24.484512111873126,24.000125446951017,0],[-24.62405387732605,24.10719960953328,0],[-24.786553704937702,24.174509242013315,0],[-25.135321295062298,24.174509242013315,0]]) ;
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.22';
	//rect.bindPopup('Задвижка 2');
	rect.bindTooltip('Задвижка 2')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	bounds=FlipLL([[-15.805724822874822,24.12528266264653,0],[-15.955933320143197,24.063064265894287,0],[-16.084920280947568,23.964089089771708,0],[-16.183895457070143,23.83510212896734,0],[-16.246113853822386,23.684893631698962,0],[-16.267335390286394,23.523700058824144,0],[-16.246113853822386,23.362506485949325,0],[-16.183895457070143,23.212297988680948,0],[-16.084920280947568,23.08331102787658,0],[-15.955933320143197,22.984335851754,0],[-15.805724822874822,22.922117455001757,0],[-15.644531250000002,22.900895918537753,0],[-15.483337677125181,22.922117455001757,0],[-15.333129179856806,22.984335851754,0],[-15.204142219052436,23.08331102787658,0],[-15.10516704292986,23.212297988680948,0],[-15.042948646177617,23.362506485949325,0],[-15.021727109713611,23.523700058824144,0],[-15.042948646177617,23.684893631698962,0],[-15.10516704292986,23.83510212896734,0],[-15.204142219052436,23.964089089771708,0],[-15.333129179856805,24.063064265894287,0],[-15.483337677125181,24.12528266264653,0],[-15.805724822874822,24.12528266264653,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.23';
	//rect.bindPopup('Задвижка 3');
	rect.bindTooltip('Задвижка 3')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	 
	
	bounds=FlipLL([[-15.012991121964754,-10.28129433758153,0],[-15.16159862735708,-10.342849581785464,0],[-15.289210785270003,-10.440769834546282,0],[-15.387131038030821,-10.568381992459205,0],[-15.448686282234755,-10.71698949785153,0],[-15.469681629714156,-10.876464994816283,0],[-15.448686282234755,-11.035940491781036,0],[-15.387131038030821,-11.184547997173361,0],[-15.289210785270003,-11.312160155086284,0],[-15.16159862735708,-11.410080407847103,0],[-15.012991121964754,-11.471635652051036,0],[-14.853515625000002,-11.492630999530437,0],[-14.69404012803525,-11.471635652051036,0],[-14.545432622642924,-11.410080407847103,0],[-14.417820464730001,-11.312160155086284,0],[-14.319900211969182,-11.18454799717336,0],[-14.258344967765249,-11.035940491781036,0],[-14.237349620285848,-10.876464994816283,0],[-14.258344967765249,-10.71698949785153,0],[-14.319900211969182,-10.568381992459207,0],[-14.417820464730001,-10.440769834546282,0],[-14.545432622642924,-10.342849581785464,0],[-14.694040128035248,-10.28129433758153,0],[-15.012991121964754,-10.28129433758153,0]]) ;
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.24';
	//rect.bindPopup('Задвижка 4');
	rect.bindTooltip('Задвижка 4')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	
	bounds=FlipLL([[-26.53736025908123,-25.559783292839914,0],[-26.695936025854845,-25.625467526101257,0],[-26.832108123874086,-25.729956051921135,0],[-26.936596649693964,-25.866128149940373,0],[-27.002280882955308,-26.024703916713992,0],[-27.02468455170969,-26.194876675795218,0],[-27.002280882955308,-26.36504943487644,0],[-26.936596649693964,-26.52362520165006,0],[-26.832108123874086,-26.6597972996693,0],[-26.695936025854845,-26.76428582548918,0],[-26.537360259081225,-26.829970058750522,0],[-26.367187500000004,-26.852373727504904,0],[-26.197014740918778,-26.829970058750522,0],[-26.03843897414516,-26.76428582548918,0],[-25.90226687612592,-26.6597972996693,0],[-25.797778350306043,-26.52362520165006,0],[-25.7320941170447,-26.365049434876443,0],[-25.709690448290317,-26.194876675795218,0],[-25.7320941170447,-26.024703916713996,0],[-25.797778350306043,-25.866128149940376,0],[-25.90226687612592,-25.729956051921135,0],[-26.03843897414516,-25.62546752610126,0],[-26.197014740918778,-25.559783292839914,0],[-26.53736025908123,-25.559783292839914,0]]);
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.25';
	//rect.bindPopup('Задвижка 5');
	rect.bindTooltip('Задвижка 5')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	 
	
	bounds=FlipLL([[-17.16569107501761,-25.60202123153617,0],[-17.31372049743392,-25.663337025931263,0],[-17.440836244241446,-25.760876369053776,0],[-17.53837558736396,-25.8879921158613,0],[-17.59969138175905,-26.036021538277613,0],[-17.620605057367833,-26.194876675795218,0],[-17.59969138175905,-26.353731813312823,0],[-17.53837558736396,-26.501761235729134,0],[-17.440836244241446,-26.62887698253666,0],[-17.31372049743392,-26.726416325659173,0],[-17.16569107501761,-26.787732120054265,0],[-17.006835937500004,-26.808645795663047,0],[-16.8479807999824,-26.787732120054265,0],[-16.699951377566087,-26.726416325659173,0],[-16.57283563075856,-26.62887698253666,0],[-16.47529628763605,-26.501761235729134,0],[-16.413980493240956,-26.353731813312823,0],[-16.393066817632175,-26.194876675795218,0],[-16.413980493240956,-26.036021538277613,0],[-16.47529628763605,-25.887992115861305,0],[-16.57283563075856,-25.760876369053776,0],[-16.699951377566087,-25.663337025931263,0],[-16.847980799982395,-25.60202123153617,0],[-17.16569107501761,-25.60202123153617,0]]) ;
	rect = L.polygon(bounds, {  color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 2 });
	rect.tag = '86.26';
	//rect.bindPopup('Задвижка 6');
	rect.bindTooltip('Задвижка6')
	rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
	rect.addTo(map);
	stanki.push(rect);
	
	function FlipLL(b) {
		var fb;
		var point;
		var j;
		fb=[];
		for (j = 0; j < b.length; j++) {
			 point =new  L.latLng(
			  b[j][1],               
			  b[j][0],               
               b[j][2]             
            );
			fb.push(point)
		}
		return fb;
	}


    function ReloadData() {

               function OnRequestReady(data) {

                $.each(data.data, function (i, v) {
                    var ok = false;
                    var rect;
                    var j;
                    for (j = 0; j < stanki.length; j++) {
                        if (stanki[j].tag == v.ID) {
                            ok = true;
                            rect = stanki[j];
                            break;
                        }
                    }

                    if (ok) {
						if(v.BLINK=='YES'){
							blink=true;
						}else{
							blink=false;
						}
					
						switch (v.COLOR) {
							case 'GREEN':
								 rgb = '#00FF00'; // green
								break;
							case 'YELLOW':
								rgb = '#dddd00';
								break;
							case 'RED':
								 rgb = '#FF0000'; //red
								break;
							default:
								rgb = '#000000'; //black
								break;
						}
                        rect.setStyle({ color: rgb, opacity: 1.0, fillOpacity: 0.5, weight: 1 });
                       // //rect.bindPopup(sPopup);
                       // rect.marker.bindPopup(sPopup);
                        rect.on('contextmenu',function(event){ }); 
 rect.blink = blink;
					}
					if(v.INFO !=null){
						var item=document.getElementById('v' +v.ID);
						if( item!=null){
							item.innerHTML =v.INFO;
						}else{
							console.log(v.ID);
						}
					}
               
				});
			 }
           $.ajax({
                dataType: "json",
                url: 'l286.aspx',
                success: OnRequestReady
            });
        }
        var blinkMode = false;
        function Blinker() {
            blinkMode = !blinkMode;


            var j;
            for (j = 0; j < stanki.length; j++) {

                rect = stanki[j];
                if (rect.blink == true) {
                    if (blinkMode) {
                        rect.setStyle({  fillOpacity: 0.1 });
                    } else {
                        rect.setStyle({  fillOpacity: 0.5 });
                    }
                }
               
            }
           

        }

        ReloadData();

	var intervalID = window.setInterval(ReloadData, 1000);
		var intervalID2 = window.setInterval(Blinker, 500);
   

</script>
 
</body>
</html>
